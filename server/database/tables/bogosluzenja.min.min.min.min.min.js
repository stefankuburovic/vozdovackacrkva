const mysql=require("mysql2");const express=require("express");require("dotenv").config();const app=express();app.use(express.json());const con=mysql.createConnection({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASS,database:process.env.DB_NAME});app.get([`/api/bogosluzenja/:id`,`/api/bogosluzenja/`],(req,res)=>{con.connect(function(err){if(err)throw err;con.query(`SELECT * FROM bogosluzenja ${req.params.id&&`WHERE id=${req.params.id}`}`,function(err,result,fields){if(err)throw err;res.json(result)})})});app.get("/api/bogosluzenja/:startDate/:endDate",(req,res)=>{const{startDate,endDate}=req.params;con.connect(function(err){if(err)throw err;var sql=`SELECT * FROM bogosluzenja WHERE datum_bogosluzenja BETWEEN ? AND ?`;con.query(sql,[startDate,endDate],function(err,result){if(err)throw err;res.json(result)})})});app.get("/api/bogosluzenja/search/:condition",(req,res)=>{const{condition}=req.params;con.connect(function(err){if(err)throw err;var sql=`SELECT * FROM bogosluzenja WHERE praznik LIKE ?`;con.query(sql,[`%${condition}%`],function(err,result){if(err)throw err;res.json(result)})})});app.delete("/api/bogosluzenja/:id",(req,res)=>{const{id}=req.params;con.connect(function(err){if(err)throw err;var sql=`DELETE FROM bogosluzenja WHERE id = ?`;con.query(sql,[id],function(err,result){if(err)throw err;res.json({message:"Record deleted",result:result})})})});app.post("/api/bogosluzenja",(req,res)=>{const{praznik,datum_bogosluzenja,vreme_bogosluzenja,datum_bdenija,vreme_bdenija,dodatne_informacije}=req.body;con.connect(function(err){if(err)throw err;var sql=`INSERT INTO bogosluzenja (praznik, datum_bogosluzenja, vreme_bogosluzenja, datum_bdenija, vreme_bdenija, dodatne_informacije) VALUES (?, ?, ?, ?, ?, ?)`;con.query(sql,[praznik,datum_bogosluzenja,vreme_bogosluzenja,datum_bdenija,vreme_bdenija,dodatne_informacije],function(err,result){if(err)throw err;con.query("SELECT * FROM bogosluzenja WHERE id = ?",[result.insertId],function(err,record){if(err)throw err;res.json({message:"Record inserted",record:record[0]})})})})});app.put("/api/bogosluzenja/:id",(req,res)=>{const{id}=req.params;const{praznik,datum_bogosluzenja,vreme_bogosluzenja,datum_bdenija,vreme_bdenija,dodatne_informacije}=req.body;con.connect(function(err){if(err)throw err;var sql=`UPDATE bogosluzenja SET praznik = ?, datum_bogosluzenja = ?, vreme_bogosluzenja = ?, datum_bdenija = ?, vreme_bdenija = ?, dodatne_informacije = ? WHERE id = ?`;con.query(sql,[praznik,datum_bogosluzenja,vreme_bogosluzenja,datum_bdenija,vreme_bdenija,dodatne_informacije,id],function(err,result){if(err)throw err;con.query("SELECT * FROM bogosluzenja WHERE id = ?",[result.insertId],function(err,record){if(err)throw err;res.json({message:"Record inserted",record:record[0]})})})})});